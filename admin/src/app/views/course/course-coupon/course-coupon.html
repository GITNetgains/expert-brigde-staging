<c-card>
  <c-card-body>
    <form
      cForm
      (submit)="submit(frm)"
      #frm="ngForm"
      novalidate
      class="needs-validation"
      [validated]="customStylesValidated"
    >
      <c-container>
        <c-row>
          <c-col md="12">
            <div class="mb-3">
              <label cLabel>Name</label>
              <c-input-group class="has-validation">
                <input
                  cFormControl
                  type="text"
                  name="name"
                  placeholder="Enter name"
                  [(ngModel)]="coupon.name"
                  required
                  #name="ngModel"
                />
                @if (name.errors && (name.dirty || name.touched || isSubmitted))
                { @if (name.errors['required']) {
                <c-form-feedback invalid
                  >Please enter coupon name!</c-form-feedback
                >
                } }
              </c-input-group>
            </div>
          </c-col>
        </c-row>

        <c-row class="mb-3">
          <c-col md="6">
            <div class="mb-3">
              <label cLabel>Coupon Code</label>
              <c-input-group class="has-validation">
                <input
                  cFormControl
                  type="text"
                  name="code"
                  placeholder="Enter coupon"
                  [(ngModel)]="coupon.code"
                  required
                  #codeCoupon="ngModel"
                  pattern="[a-zA-Z0-9-_%]*"
                />
                @if (codeCoupon.errors && (codeCoupon.dirty ||
                codeCoupon.touched || isSubmitted)) { @if
                (codeCoupon.errors['required']) {
                <c-form-feedback invalid
                  >Please enter coupon code!</c-form-feedback
                >
                } @if (codeCoupon.errors['pattern']) {
                <c-form-feedback invalid
                  >Code is invalid format</c-form-feedback
                >
                } }
              </c-input-group>
            </div>
          </c-col>

          <c-col md="6">
            <div class="mb-3">
              <label cLabel>Maximum number of people who can use coupon</label>
              <c-input-group class="has-validation">
                <input
                  cFormControl
                  type="number"
                  name="maximum"
                  placeholder="Enter number"
                  [(ngModel)]="coupon.limitNumberOfUse"
                  required
                  #maximum="ngModel"
                  min="1"
                  pattern="[0-9]*"
                />
                @if (maximum.errors && (maximum.dirty || maximum.touched ||
                isSubmitted)) { @if (maximum.errors['required']) {
                <c-form-feedback invalid>Please enter value!</c-form-feedback>
                } @if (maximum.errors['pattern']) {
                <c-form-feedback invalid
                  >Value is invalid format</c-form-feedback
                >
                } } @if (maximum.value <= 0 && (maximum.dirty || maximum.touched
                || isSubmitted)) {
                <c-form-feedback invalid
                  >Value must be greater than 0!</c-form-feedback
                >
                }
              </c-input-group>
            </div>
          </c-col>
        </c-row>

        <c-row>
          <c-col md="6">
            <div class="mb-3">
              <label cLabel>Start Date</label>
              <div class="position-relative">
                <app-date-picker-custom
                  [options]="getDatePickerOptions('startTime')"
                  [defaultValue]="selectedStart"
                ></app-date-picker-custom>
                @if (!coupon.startTime && isSubmitted) {
                <c-form-feedback invalid
                  >Please enter start date!</c-form-feedback
                >
                }
              </div>
            </div>
          </c-col>

          <c-col md="6">
            <div class="mb-3">
              <label cLabel>End Date</label>
              <div class="position-relative">
                <app-date-picker-custom
                  [options]="getDatePickerOptions('expiredDate')"
                  [defaultValue]="selectedExpired"
                ></app-date-picker-custom>
                @if (!coupon.expiredDate && isSubmitted) {
                <c-form-feedback invalid
                  >Please enter expired date!</c-form-feedback
                >
                }
              </div>
            </div>
          </c-col>
        </c-row>

        <c-row>
          <c-col md="12">
            <div class="mt-3 mb-3">
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  (click)="type='percent'"
                  checked="checked"
                  name="discount"
                  value="percent"
                  id="percent"
                />
                <label class="form-check-label" for="percent">
                  Money Discount %
                </label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  (click)="type='money'"
                  name="discount"
                  value="money"
                  id="money"
                />
                <label class="form-check-label" for="money">
                  Money Discount ({{config?.currencySymbol ?
                  config?.currencySymbol : '$'}})
                </label>
              </div>
            </div>
          </c-col>
        </c-row>

        <c-row class="mb-3">
          <c-col md="6">
            <div class="mb-3">
              <c-input-group class="has-validation">
                <input
                  cFormControl
                  type="text"
                  placeholder="Enter discount"
                  [(ngModel)]="coupon.value"
                  required
                  #value="ngModel"
                  pattern="[.0-9]{0,8}"
                  name="discount"
                />
                @if (value.errors && (value.dirty || value.touched ||
                isSubmitted)) { @if (value.errors['required']) {
                <c-form-feedback invalid
                  >Please enter discount value!</c-form-feedback
                >
                } @if (value.errors['pattern']) {
                <c-form-feedback invalid
                  >Value is invalid format</c-form-feedback
                >
                } }
              </c-input-group>
            </div>
          </c-col>
        </c-row>

        <c-row>
          <c-col md="12" class="mb-3">
            <button cButton color="primary" type="submit">Save Coupon</button>
          </c-col>
        </c-row>

        <c-row>
          <c-col md="12">
            <button cButton color="primary" type="button" (click)="onTab(3)">
              Previous
            </button>
            <button
              cButton
              color="primary"
              type="button"
              class="ms-3"
              routerLink="/courses/list"
            >
              Finish Course
            </button>
          </c-col>
        </c-row>
      </c-container>
    </form>
  </c-card-body>
</c-card>
