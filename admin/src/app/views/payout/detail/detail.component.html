<c-row class="mb-4">
  <c-col>
    <c-card>
      <c-card-header>
        <h4>General Information</h4>
      </c-card-header>
      <c-card-body>
        <table
          cTable
          [responsive]="true"
          [cBorder]="1"
          borderColor="gray"
          bordered
        >
          <tbody>
            <tr>
              <th>Code</th>
              <td>{{ item?.code }}</td>
            </tr>
            <tr>
              <th>Expert</th>
              <td>
                <a
                  [routerLink]="['/tutor/update', item.tutor.id]"
                  *ngIf="item && item.tutor"
                  >{{ item?.tutor?.name }}</a
                >
              </td>
            </tr>
            <tr>
              <th>Created On</th>
              <td>{{ item.createdAt | date }}</td>
            </tr>
            <tr>
              <th>Request To Date</th>
              <td>{{ item.requestToTime | date }}</td>
            </tr>
            <tr>
              <th>Total Balance</th>
              <td>
                <c-badge color="success">{{
                  item?.total
                    | currency
                      : (config?.currencySymbol ? config?.currencySymbol : "$")
                      : "symbol"
                      : "1.0"
                }}</c-badge>
              </td>
            </tr>
            <tr>
              <th>Commission</th>
              <td>
                {{
                  item?.commission
                    | currency
                      : (config?.currencySymbol ? config?.currencySymbol : "$")
                      : "symbol"
                      : "1.0"
                }}
              </td>
            </tr>
            <tr>
              <th>Expert Balance</th>
              <td>
                {{
                  item?.balance
                    | currency
                      : (config?.currencySymbol ? config?.currencySymbol : "$")
                      : "symbol"
                      : "1.0"
                }}
              </td>
            </tr>
            <tr>
              <th>Request Attempts</th>
              <td>
                {{ item?.requestAttempts }}
              </td>
            </tr>
            <tr>
              <th>Status</th>
              <td>
                @switch (item.status) { @case('approved'){
                <c-badge color="success">Approved</c-badge>
                } @case('rejected'){
                <c-badge color="danger">Rejected</c-badge>
                } @case('pending'){
                <c-badge color="warning">Pending</c-badge>
                } }
              </td>
            </tr>
            <tr>
              <th>Note</th>
              <td>
                {{ item?.note }}
              </td>
            </tr>
            <tr>
              <th>Reject Reason</th>
              <td>
                {{ item?.rejectReason }}
              </td>
            </tr>
          </tbody>
        </table>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>
@if (status === 'pending') {
<c-row [gutter]="3" class="mb-4">
  <c-col xs="12" sm="12" md="6">
    <c-card>
      <c-card-header>
        <h4>Approve Request</h4>
      </c-card-header>
      <c-card-body>
        <label cLabel>
          <strong>Note</strong>
        </label>
        <textarea
          cFormControl
          id="approveNote"
          name="approveNote"
          rows="3"
          placeholder="Optional note"
          [(ngModel)]="info.note"
        ></textarea>
      </c-card-body>
      <c-card-footer class="text-end">
        <button
          cButton
          color="success"
          class="text-white"
          (click)="approve(item)"
        >
          Approve
        </button>
      </c-card-footer>
    </c-card>
  </c-col>
  <c-col xs="12" sm="12" md="6">
    <c-card>
      <c-card-header>
        <h4>Reject Request</h4>
      </c-card-header>
      <c-card-body>
        <c-row [gutter]="3">
          <c-col md="12">
            <label cLabel>
              <strong>Reject Reason</strong>
            </label>
            <textarea
              cFormControl
              id="rejectReason"
              name="rejectReason"
              rows="2"
              placeholder="Required"
              [(ngModel)]="info.rejectReason"
            ></textarea>
          </c-col>
          <c-col md="12">
            <label cLabel>
              <strong>Note</strong>
            </label>
            <textarea
              cFormControl
              id="rejectNote"
              name="rejectNote"
              rows="2"
              placeholder="Optional"
              [(ngModel)]="info.note"
            ></textarea>
          </c-col>
        </c-row>
      </c-card-body>
      <c-card-footer class="text-end">
        <button
          cButton
          color="danger"
          class="text-white"
          (click)="reject(item)"
        >
          Reject
        </button>
      </c-card-footer>
    </c-card>
  </c-col>
</c-row>
}
<c-row>
  <c-col>
    <c-card>
      <c-card-header>
        <h4>Payout Account</h4>
      </c-card-header>
      <c-card-body>
        <c-container>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Payout Type</strong></c-col>
            <c-col xs="9" class="border py-2">
              {{ item?.payoutAccount?.type === 'paypal' ? 'PayPal' : 'Bank Transfer' }}
            </c-col>
          </c-row>

          @if (item?.payoutAccount?.type === 'paypal') {
          <c-row xs="4" class="mt-2">
            <c-col xs="12" class="border-bottom py-2"><strong>PayPal details</strong></c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>PayPal registered email address</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.paypalAccount }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Account Holder's Name</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.accountHolderName }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Address</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.accountHolderAddress }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Pincode or Postal Code</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.accountHolderPostalCode }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Tax ID (TIN) or Unique Identification Number</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.taxIdNumber || '—' }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Unique Identification Number Type</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.uniqueIdentificationNumberType || '—' }}</c-col>
          </c-row>
          } @else {
          <c-row xs="4" class="mt-2">
            <c-col xs="12" class="border-bottom py-2"><strong>Bank Transfer details</strong></c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Bank account region</strong></c-col>
            <c-col xs="9" class="border py-2">
              {{ item?.payoutAccount?.bankAccountRegion === 'uk' ? 'United Kingdom (UK)' : item?.payoutAccount?.bankAccountRegion === 'india' ? 'India' : item?.payoutAccount?.bankAccountRegion === 'us' ? 'United States (US)' : item?.payoutAccount?.bankAccountRegion === 'other' ? 'Other countries' : (item?.payoutAccount?.bankAccountRegion || '—') }}
            </c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Account Holder</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.accountHolderName }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Account Holder Address</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.accountHolderAddress }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Account Holder Pincode / Postal Code</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.accountHolderPostalCode }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Bank Name</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.bankName }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Receiver Bank SWIFT code</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.swiftCode }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Receiver Bank SORT Number (For US)</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.sortCode }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Receiver Bank IBAN (For Other Countries)</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.iban }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Account title (Personal Account)</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.isPersonalAccount ? 'Yes' : 'No' }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Bank Address</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.bankAddress }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Account number</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.accountNumber }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Tax ID (TIN) or Unique Identification Number</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.taxIdNumber || '—' }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>Unique Identification Number Type</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.uniqueIdentificationNumberType || '—' }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>ABA Routing Number</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.routingNumber }}</c-col>
          </c-row>
          <c-row xs="4">
            <c-col xs="3" class="border py-2"><strong>IFSC / Other local code</strong></c-col>
            <c-col xs="9" class="border py-2">{{ item?.payoutAccount?.ifscCode || item?.payoutAccount?.routingCode }}</c-col>
          </c-row>
          }
        </c-container>
      </c-card-body>
      <c-card-footer>
        <c-row>
          <c-col class="d-flex justify-content-end gap-2">
            <a [routerLink]="['/payout/request']" class="btn btn-secondary">Back to list</a>
          </c-col>
        </c-row>
      </c-card-footer>
    </c-card>
  </c-col>
</c-row>
