<div class="expert-card expert-card-favorite">
  <!-- HEADER (same structure as tutor card + rating + optional Featured badge) -->
  <div class="expert-header">
    <a [routerLink]="['/experts', tutor.username]" class="avatar-wrap avatar-link">
      <img
        *ngIf="tutor.showPublicIdOnly !== true"
        class="avatar"
        [src]="tutor.avatarUrl || 'assets/images/default-avatar.jpg'"
        onerror="this.src='assets/images/default-avatar.jpg'"
        alt="avatar"
      />
      <span *ngIf="tutor.showPublicIdOnly === true" class="avatar avatar-placeholder" aria-hidden="true"><i class="fi fi-rr-user"></i></span>
    </a>

    <div class="expert-meta">
      <div class="name-location">
        <h3 class="name">
          <a [routerLink]="['/experts', tutor.username]">
            {{ tutor.showPublicIdOnly === true ? tutor.userId : tutor.name }}
          </a>
          <i class="fi fi-ss-badge-check color-blue ms-1 font-sm" *ngIf="$any(tutor).verified"></i>
        </h3>
        <p class="location">
          {{ (tutor.state && tutor.country?.name) ? (tutor.state + ', ' + tutor.country.name) : (tutor.state || tutor.country?.name || '') }}
        </p>
      </div>

      <!-- Rating (favourite card highlight) -->
      <div class="rating-block">
        <app-star-rating [rate]="tutor.ratingAvg"></app-star-rating>
        <span class="rating-text">{{ tutor.ratingAvg | number:'1.1-1' }} ({{ tutor.totalRating || 0 }} reviews)</span>
      </div>

      <p class="fee">
        <img src="./assets/images/card-fee-icon.svg" alt="fee-icon" onerror="this.style.display='none'" /> Consultation Fee:
        <a>{{ ($any(tutor).price1On1Class != null && $any(tutor).price1On1Class !== '') ? ($any(tutor).price1On1Class | appCurrency) : '—' }}/hr</a>
      </p>
    </div>

    <!-- Featured badge in header flow so it never overlaps name -->
    <div class="badge-tag" *ngIf="tutor.featured">
      <span translate>Featured</span>
    </div>
  </div>

  <!-- EXPERIENCE -->
  <div class="experience" *ngIf="$any(tutor).experience?.length">
    <div
      class="experience-item"
      *ngFor="let exp of $any(tutor).experience | slice:0:4"
    >
      <span class="red-arrow">▶</span>
      <span>{{ ($any(exp).title || '') + ($any(exp).organization ? ' at ' + $any(exp).organization : '') + (($any(exp).fromYear || $any(exp).toYear) ? ' (' + ($any(exp).fromYear || '') + ($any(exp).fromYear && $any(exp).toYear ? '–' : '') + ($any(exp).toYear || '') + ')' : '') || 'Experience' }}</span>
    </div>
  </div>

  <!-- HIGHLIGHTS (description) -->
  <div class="description" *ngIf="$any(tutor).highlights?.length">
    <div
      class="desc-item"
      *ngFor="let d of $any(tutor).highlights | slice:0:4"
    >
      – {{ d }}
    </div>
  </div>

  <!-- DIVIDER -->
  <div class="divider"></div>

  <!-- ACTIONS -->
  <div class="card-actions">
    <a [routerLink]="['/experts', tutor.username]">Watch</a>
    <a [routerLink]="['/experts', tutor.username, 'booking']" [queryParams]="{ isFree: 'true' }">Book Free Trial</a>
    <a (click)="favorite()" *ngIf="!tutor.isFavorite">Shortlist</a>
    <a (click)="unFavorite()" *ngIf="tutor.isFavorite">Remove</a>
    <a (click)="chat()">Chat</a>

    <a [routerLink]="['/experts', tutor.username]" class="open-icon-link"><i class="fi fi-rr-arrow-up-right open-icon"></i></a>
  </div>
</div>
