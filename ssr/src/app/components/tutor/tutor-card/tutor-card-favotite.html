<div class="expert-card modern-design">
  <button class="fav-button" 
          (click)="tutor.isFavorite ? unFavorite() : favorite()" 
          [class.is-fav]="tutor.isFavorite"
          [attr.aria-label]="tutor.isFavorite ? 'Remove from favorites' : 'Add to favorites'">
    <i [class]="tutor.isFavorite ? 'fi fi-ss-heart' : 'fi fi-rs-heart'"></i>
  </button>

  <div class="card-content">
    <div class="expert-header">
      <div class="avatar-section">
        <a [routerLink]="['/experts', tutor.username]" class="avatar-link">
          <img *ngIf="tutor.showPublicIdOnly !== true" 
               [src]="tutor.avatarUrl || 'assets/images/default-avatar.jpg'" 
               class="avatar-img" />
          <div *ngIf="tutor.showPublicIdOnly === true" class="avatar-placeholder">
            <i class="fi fi-rr-user"></i>
          </div>
        </a>
        <span class="badge-featured" *ngIf="tutor.featured">Featured</span>
      </div>

      <div class="expert-info">
        <h3 class="name">
          <a [routerLink]="['/experts', tutor.username]">
            {{ tutor.showPublicIdOnly === true ? tutor.userId : tutor.name }}
          </a>
          <i class="fi fi-ss-badge-check verified-icon" *ngIf="$any(tutor).verified"></i>
        </h3>
        <p class="location">
          <i class="fi fi-rr-marker"></i> 
          {{ (tutor.state && tutor.country?.name) ? (tutor.state + ', ' + tutor.country.name) : (tutor.state || tutor.country?.name || '') }}
        </p>
        <div class="rating-row">
          <app-star-rating [rate]="tutor.ratingAvg"></app-star-rating>
          <span class="rating-count">({{ tutor.totalRating || 0 }})</span>
        </div>
      </div>
    </div>

    <div class="card-body">
      <div class="fee-row">
        <span class="fee-label">Consultation:</span>
        <span class="fee-amount">{{ ($any(tutor).price1On1Class != null) ? ($any(tutor).price1On1Class | appCurrency) : 'â€”' }}/hr</span>
      </div>

      <div class="experience-box" *ngIf="$any(tutor).experience?.length">
        <div class="exp-item" *ngFor="let exp of $any(tutor).experience | slice:0:1">
          <i class="fi fi-rr-briefcase"></i>
          <span class="text-truncate">{{ $any(exp).title }} at {{ $any(exp).organization }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card-footer">
    <div class="primary-actions">
      <button class="btn-outline-custom" [routerLink]="['/experts', tutor.username]">View</button>
      <button class="btn-primary-custom" [routerLink]="['/experts', tutor.username, 'booking']">Book</button>
    </div>
    <button class="chat-btn" (click)="chat()" title="Message Expert">
      <i class="fi fi-rr-comment-alt"></i>
    </button>
  </div>
</div>

<style>
.modern-design {
  display: flex;
  flex-direction: column;
  height: 100%;
  background: #ffffff;
  border: 1px solid #eaeaea;
  border-radius: 16px;
  padding: 1.25rem;
  position: relative;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
  }

  /* Favorite Button */
  .fav-button {
    position: absolute;
    top: 12px;
    right: 12px;
    z-index: 5;
    width: 34px;
    height: 34px;
    border-radius: 50%;
    border: none;
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: 0.2s;

    i { color: #bfbfbf; font-size: 1rem; }
    
    &.is-fav {
      background: #fff0f0;
      i { color: #ff4d4f; }
    }
    
    &:hover { transform: scale(1.1); background: #eee; }
  }

  /* Header Section */
  .expert-header {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;

    .avatar-section {
      position: relative;
      .avatar-img, .avatar-placeholder {
        width: 64px;
        height: 64px;
        border-radius: 12px;
        object-fit: cover;
        background: #f0f2f5;
      }
      .badge-featured {
        position: absolute;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        background: #ffc107;
        color: #000;
        font-size: 0.65rem;
        font-weight: 800;
        padding: 2px 8px;
        border-radius: 10px;
        white-space: nowrap;
      }
    }

    .expert-info {
      flex: 1;
      min-width: 0; 
      
      .name {
        font-size: 1rem;
        font-weight: 700;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 4px;
        a { color: #1a1a1a; text-decoration: none; display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .verified-icon { color: #007bff; font-size: 0.85rem; }
      }

      .location {
        font-size: 0.8rem;
        color: #6c757d;
        margin: 4px 0;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
    }
  }

  /* Body Content */
  .card-body {
    flex: 1;
    .fee-row {
      margin-bottom: 0.75rem;
      .fee-label { font-size: 0.75rem; color: #888; }
      .fee-amount { font-weight: 700; color: #28a745; margin-left: 5px; }
    }
    .experience-box {
      .exp-item {
        font-size: 0.75rem;
        color: #555;
        display: flex;
        align-items: center;
        gap: 6px;
        i { color: #007bff; }
      }
    }
  }

  /* Footer Actions */
  .card-footer {
    padding-top: 1rem;
    margin-top: 1rem;
    border-top: 1px solid #f0f0f0;
    background: transparent;
    display: flex;
    gap: 8px;
    align-items: center;

    .primary-actions {
      display: flex;
      gap: 6px;
      flex: 1;
      
      button {
        flex: 1;
        padding: 8px 4px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.8rem;
        transition: 0.2s;
      }
    }

    .btn-primary-custom { background: #007bff; color: #fff; border: none; &:hover { background: #0056b3; } }
    .btn-outline-custom { background: #fff; border: 1px solid #dcdcdc; color: #333; &:hover { border-color: #007bff; color: #007bff; } }

    .chat-btn {
      width: 38px;
      height: 38px;
      border-radius: 8px;
      background: #f0f7ff;
      border: none;
      color: #007bff;
      display: flex;
      align-items: center;
      justify-content: center;
      &:hover { background: #007bff; color: #fff; }
    }

    /* 1024px & Small Desktop Responsiveness */
    @media (max-width: 1200px) {
      flex-direction: column;
      align-items: stretch;
      .primary-actions { width: 100%; }
      .chat-btn { width: 100%; height: 35px; }
    }
  }
}

  </style>
